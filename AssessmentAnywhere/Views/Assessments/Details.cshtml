@model AssessmentAnywhere.Models.Assessments.DetailsModel
@{
    ViewBag.Title = Model.Name;
    Layout = "_Layout.cshtml";
}

@section Head
{
    <link href="@Url.Content("~/css/kendo.common.min.css")" rel="stylesheet" />
    <link href="@Url.Content("~/css/kendo.bootstrap.min.css")" rel="stylesheet" />
    <style type="text/css">
        .sidebar-nav {
            padding: 9px 0;
        }
    </style>
}

@using (Html.BeginForm("Update", "Assessments", new { id = Model.Id }, FormMethod.Post))
{
    <div class="row-fluid">
        <div class="span3">
            <div class="well sidebar-nav">
                <ul class="nav nav-list">
                    <li>
                        <a href="@Url.Action("Index")">
                            <i class="icon-arrow-left"></i>
                            back to assessments
                        </a>
                    </li>
                    <li class="nav-header">Actions</li>
                    <li class="disabled">
                        <a href="#" title="Coming soon!">
                            <i class="icon-download-alt"></i>
                            Import names...
                        </a>
                    </li>
                    <li class="disabled">
                        <a href="#" title="Coming soon!">
                            <i class="icon-arrow-down"></i>
                            Sort results...
                        </a>
                    </li>
                    <li class="disabled">
                        <a href="#" title="Coming soon!">
                            <i class="icon-pencil"></i>
                            Edit grade boundaries...
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="span9">
            <div class="row-fluid">
                <div class="span6">
                    @Html.TextBoxFor(m => m.Name, new { title = "Assessment name", @class = "span12" })
                </div>
                <div class="span5 form-inline">
                    @Html.LabelFor(m => m.TotalMarks, "Out of: ")
                    @Html.TextBoxFor(m => m.TotalMarks, new { @class = "input-mini", type = "number", placeholder = "total #" })
                </div>
                <div class="span1">
                    <input type="submit" class="btn btn-primary pull-right" value="Save changes" title="Hint: you can also just press enter!" />
                </div>
            </div>
            <div class="row-fluid">
                <table class="table table-bordered table-striped" id="candidates">
                    <caption></caption>
                    <thead>
                        <tr>
                            <th>Surname, Fornames</th>
                            <th>Result</th>
                            <th>Percentage</th>
                            <th>Grade</th>
                            @if (Model.Results.Any())
                            {
                                <th></th>
                            }
                        </tr>
                    </thead>
                    <tbody>
                        @for (int i = 0; i < Model.Results.Count; i++)
                        {
                            <tr>
                                <td>
                                    @Html.HiddenFor(m => m.Results[i].RowId)
                                    <div class="input-append">
                                        @Html.TextBoxFor(m => m.Results[i].Surname,
                                    new
                                    {
                                        @class = "input-small",
                                        placeholder = "Surname",
                                        tabindex = (i * 2) + 1,
                                    })
                                        <span class="add-on">,</span>
                                    </div>
                                    @Html.TextBoxFor(m => m.Results[i].Forenames,
                                    new
                                        {
                                            @class = "input-small",
                                            placeholder = "Forenames",
                                            tabindex = (i * 2) + 2
                                        })
                                </td>
                                <td>
                                    @if (Model.SelectedResultIndex.HasValue && Model.SelectedResultIndex.Value == i)
                                    {
                                        @Html.TextBoxFor(m => m.Results[i].Result,
                                            new
                                                {
                                                    @class = "input-mini",
                                                    placeholder = "#",
                                                    autofocus = "autofocus",
                                                    tabindex = (Model.Results.Count * 2) + 3 + i,
                                                })
                                    }
                                    else
                                    {
                                        @Html.TextBoxFor(m => m.Results[i].Result,
                                            new
                                                {
                                                    @class = "input-mini",
                                                    placeholder = "#",
                                                    tabindex = (Model.Results.Count * 2) + 3 + i,
                                                })
                                    }
                                </td>
                                <td>
                                    <div class="input-append">
                                        @Html.TextBoxFor(m => m.Results[i].Percentage,
                                        new
                                            {
                                                @class = "input-mini",
                                                disabled = "disabled",
                                            })
                                        <span class="add-on">%</span>
                                    </div>
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Results[i].Grade,
                                        new
                                            {
                                                @class = "input-mini",
                                                disabled = "disabled",
                                            })
                                </td>
                                <td>
                                    <a href="@Url.Action("DeleteResultRow", new { id = Model.Id, rowId = Model.Results[i].RowId })" class="btn btn-danger">
                                        <i class="icon-remove"></i>
                                        Delete
                                    </a>
                                </td>
                            </tr>
                        }
                        <tr>
                            <td>
                                @if (Model.SelectedResultIndex.HasValue)
                                {
                                    <div class="input-append">
                                        @Html.TextBox("Results[" + Model.Results.Count + "].Surname", "",
                                    new
                                        {
                                            placeholder = "Surname",
                                            @class = "input-small",
                                        })
                                        <span class="add-on">,</span>
                                    </div>
                                }
                                else
                                {
                                    <div class="input-append">
                                        @Html.TextBox("Results[" + Model.Results.Count + "].Surname", "",
                                    new
                                        {
                                            placeholder = "Surname",
                                            @class = "input-small",
                                            autofocus = "autofocus",
                                            tabindex = (Model.Results.Count * 2) + 1,
                                        })
                                        <span class="add-on">,</span>
                                    </div>
                                }
                                @Html.TextBox("Results[" + Model.Results.Count + "].Forenames", "",
                                    new
                                        {
                                            placeholder = "Forenames",
                                            @class = "input-small",
                                            tabindex = (Model.Results.Count * 2) + 2,
                                        })
                            </td>
                            <td>
                                @Html.TextBox("Results[" + Model.Results.Count + "].Result", "",
                                new
                                    {
                                        @class = "input-mini",
                                        type = "number",
                                        disabled = "disabled",
                                        placeholder = "#",
                                    })
                            </td>
                            <td>
                                <div class="input-append">
                                    @Html.TextBox("Results[" + Model.Results.Count + "].Percentage", "",
                                    new
                                        {
                                            @class = "input-mini",
                                            disabled = "disabled",
                                        })
                                    <span class="add-on">%</span>
                                </div>
                            </td>
                            <td>
                                @Html.TextBox("Results[" + Model.Results.Count + "].Grade", "",
                                    new
                                        {
                                            @class = "input-mini",
                                            disabled = "disabled",
                                        })
                            </td>
                            @if (Model.Results.Any())
                            {
                                <td></td>
                            }
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
}

@section Scripts
{
    <script type="text/javascript">
        $(function () {
        });
    </script>
}
